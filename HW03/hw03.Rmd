---
title: "HW03"
author: "Elena Burkey"
date: "2/22/2021"
output: 
  html_document:
    theme: paper
  github_document: default
---



```{r setup, include = False}
knitr::opts_chunk$set(echo = TRUE)
dictionary <- readr::read_csv("green_dictionary.csv")
green_data <- readr::read_csv("green_data.csv")
library(tibble)
library(ggplot2)
library(tidyverse)
library(gridExtra)
library(reshape2)
library(ggdist)
library(psychTools)
```

# Homework 03

You will analyze data looking at the relationship between **green reputation** and three personality traits--**compassion**, **intellectual curiosity**, and **openness to experiences**.
The dataset includes data from **students** and **non-students**.

## 1)
Inspect the item responses (e.g., with graphs or by summarizing distinct values).     Is anything unusual?

```{r}
as_tibble(green_data)
```

- Looking at the data set it seems that there are quite a bit of NA values which could mean a variety of things along with 

```{r}
green_data.melt <- melt(green_data, measures.var = across (c:green1:open10))
```

- Brings the data from columns to rows by using the melt function and will show everything in the data set in such a manner that it's easily seen if there are repeating values or if anything is off with the data set 

```{r}
summary(green_data.melt)
```

- It can be seen in the data that -99 is being said to be the minimum value and therefore needs to be recoded 

```{r}
ggplot(green_data.melt) + 
  aes( x = value, y = id) +
  geom_point() +
```

## 2)
Compute total scores for the four scales. 
    Recode variables as needed.

```{r}
reversed <- dictionary %>%
  filter(Keying == -1 | Keying == -2)%>%
  pull(Item)
```

```{r recode}
Green_New <- green_data %>%
  mutate(student = recode (student, "1" = "Not_Student", "2" = "Student", .missing = "No_Response", .default = "Unknown")) %>%
  select(id, student)
```

```{r}
green_data %>%
  mutate(across(everything(),
                ~ na_if(.x, -99)))
```

- Taking away  the -99 values and coding them into missing data 

```{r}
Green_R <- green_data %>%
  mutate(across(all_of(reversed), 
                ~ recode(.x, 
                         "5" = 1,
                         "4" = 2,
                         "3" = 3,
                         "2" = 4,
                         "1" = 5)))
```

- Recoded the data to organize it properly and categorize it in a way that is more clear 


```{r}
Green_Calculations <- green_data %>%
  rowwise() %>%
  mutate(tot_green = mean(c_across(green1 : green5), na.rm = TRUE),
         tot_comp = mean(c_across(comp1 : comp10), na.rm = TRUE), 
         tot_intel = mean(c_across(intel1 : intel10), na.rm = TRUE),
         tot_open = mean(c_across(open1 : open10), na.rm = TRUE))
```

 
## 3)
Rescale the variables so that they go from 0-100 instead of the original range.
     Name the recaled variables `*_pomp`.

```{r}
Green_Rescale <- green_data %>%
  mutate(across(all_of(reversed),~ recode(.x, "1" = 0, "2" = 25, "4" = 75, "5" = 100))) %>%
  rowwise() %>%
  mutate()
    
    
    green_pomp = rescale(tot_green, to = C(0, 100), from = C(1,5)),
    comp_pomp = rescale(tot_comp, to = C(0, 100), from = C(1,5)), 
    intel_pomp = rescale(tot_intel, to = C(0, 100), from = C(1,5)),
    open_pomp = rescale(tot_open, to = C(0, 100), from = C(1,5))) %>%
  select(id, student, green_pomp, comp_pomp, intel_pomp, open_pomp)
```
     
##4)
Make plots that illustrate the distributions of the 4 POMP-scored variables.


##5)
Make scatterplots showing the relationships between **green reputation** and each personality trait.
     Include trend lines for **students** and **non-students**.
     What do these plots show?
     
##6)
Compare **green reputation** for students and non-students using a **rainfall plot** (bar + density + data points).
 
#7) 
Compute a summary table of means, SDs, medians, minima, and maxima for the four total scores for students and non-students.
  
In your assignment, prepare an RMarkdown file that includes both the coding and (for 4-7) narrative descriptions of your results.
